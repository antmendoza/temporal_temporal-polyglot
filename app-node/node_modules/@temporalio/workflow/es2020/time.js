import Long from 'long';
import ms from 'ms';
/**
 * Lossy conversion function from Timestamp to number due to possible overflow
 */
export function tsToMs(ts) {
    if (ts === undefined || ts === null) {
        throw new Error(`Expected timestamp, got ${ts}`);
    }
    const { seconds, nanos } = ts;
    return (seconds || Long.UZERO)
        .mul(1000)
        .add(Math.floor((nanos || 0) / 1000000))
        .toNumber();
}
export function msToTs(millis) {
    const seconds = Math.floor(millis / 1000);
    const nanos = (millis % 1000) * 1000000;
    return { seconds: Long.fromNumber(seconds), nanos };
}
export function msStrToTs(str) {
    return msToTs(ms(str));
}
export function msOptionalStrToTs(str) {
    if (str === undefined)
        return undefined;
    return msToTs(ms(str));
}
export function nullToUndefined(x) {
    if (x === null)
        return undefined;
    return x;
}
